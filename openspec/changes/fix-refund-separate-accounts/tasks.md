# 任务列表

## 1. 代码修复

**负责人**: 开发人员
**预计时间**: 1小时
**依赖**: 无

### 子任务

- [x] 1.1 分析原Python版本的退费审批分账逻辑
- [x] 1.2 修复`approval_flow_service.go`中的`processRefundApproval`方法
  - [x] 删除重复的变量定义(第644-662行)
  - [x] 修复退费类分账明细生成逻辑
  - [x] 确保退费类分账在冲回流程外独立执行
- [x] 1.3 代码review和格式化

## 2. 单元测试

**负责人**: 开发人员
**预计时间**: 1小时
**依赖**: 任务1

### 子任务

- [x] 2.1 创建测试脚本(test_refund_separate_fix.go)
- [ ] 2.2 编写退费审批通过的测试用例(需要冲回场景)
- [ ] 2.3 编写退费审批通过的测试用例(不需要冲回场景)
- [ ] 2.4 验证退费类分账明细的正确性
- [ ] 2.5 验证子订单和订单状态更新的正确性

## 3. 集成测试

**负责人**: 测试人员
**预计时间**: 1小时
**依赖**: 任务2

### 子任务

- [ ] 3.1 准备测试数据(创建订单、收款、退费订单)
- [ ] 3.2 执行退费审批通过流程
- [ ] 3.3 验证分账明细表数据正确性
- [ ] 3.4 验证订单和子订单状态正确性
- [ ] 3.5 对比Python版本和Go版本的输出结果

## 4. 文档更新

**负责人**: 开发人员
**预计时间**: 0.5小时
**依赖**: 任务3

### 子任务

- [ ] 4.1 更新CHANGELOG
- [ ] 4.2 更新相关技术文档
- [ ] 4.3 记录修复的问题和解决方案

## 5. 发布上线

**负责人**: 运维人员
**预计时间**: 0.5小时
**依赖**: 任务4

### 子任务

- [ ] 5.1 合并代码到develop分支
- [ ] 5.2 部署到测试环境验证
- [ ] 5.3 合并到main分支
- [ ] 5.4 发布到生产环境

## 总结

- **总预计时间**: 4小时
- **关键路径**: 任务1 → 任务2 → 任务3 → 任务4 → 任务5
- **可并行任务**: 无
